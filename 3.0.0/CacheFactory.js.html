<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>CacheFactory.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BinaryHeap.html">BinaryHeap</a><ul class='methods'><li data-type='method'><a href="BinaryHeap.html#peek">peek</a></li><li data-type='method'><a href="BinaryHeap.html#pop">pop</a></li><li data-type='method'><a href="BinaryHeap.html#push">push</a></li><li data-type='method'><a href="BinaryHeap.html#remove">remove</a></li><li data-type='method'><a href="BinaryHeap.html#removeAll">removeAll</a></li><li data-type='method'><a href="BinaryHeap.html#size">size</a></li></ul></li><li><a href="Cache.html">Cache</a><ul class='methods'><li data-type='method'><a href="Cache.html#destroy">destroy</a></li><li data-type='method'><a href="Cache.html#disable">disable</a></li><li data-type='method'><a href="Cache.html#enable">enable</a></li><li data-type='method'><a href="Cache.html#get">get</a></li><li data-type='method'><a href="Cache.html#info">info</a></li><li data-type='method'><a href="Cache.html#keys">keys</a></li><li data-type='method'><a href="Cache.html#keySet">keySet</a></li><li data-type='method'><a href="Cache.html#put">put</a></li><li data-type='method'><a href="Cache.html#remove">remove</a></li><li data-type='method'><a href="Cache.html#removeAll">removeAll</a></li><li data-type='method'><a href="Cache.html#removeExpired">removeExpired</a></li><li data-type='method'><a href="Cache.html#setCacheFlushInterval">setCacheFlushInterval</a></li><li data-type='method'><a href="Cache.html#setCapacity">setCapacity</a></li><li data-type='method'><a href="Cache.html#setDeleteOnExpire">setDeleteOnExpire</a></li><li data-type='method'><a href="Cache.html#setMaxAge">setMaxAge</a></li><li data-type='method'><a href="Cache.html#setOnExpire">setOnExpire</a></li><li data-type='method'><a href="Cache.html#setOptions">setOptions</a></li><li data-type='method'><a href="Cache.html#setRecycleFreq">setRecycleFreq</a></li><li data-type='method'><a href="Cache.html#setStorageMode">setStorageMode</a></li><li data-type='method'><a href="Cache.html#touch">touch</a></li><li data-type='method'><a href="Cache.html#values">values</a></li></ul></li><li><a href="CacheFactory.html">CacheFactory</a><ul class='methods'><li data-type='method'><a href="CacheFactory.html#clearAll">clearAll</a></li><li data-type='method'><a href="CacheFactory.html#createCache">createCache</a></li><li data-type='method'><a href="CacheFactory.html#destroy">destroy</a></li><li data-type='method'><a href="CacheFactory.html#destroyAll">destroyAll</a></li><li data-type='method'><a href="CacheFactory.html#disableAll">disableAll</a></li><li data-type='method'><a href="CacheFactory.html#enableAll">enableAll</a></li><li data-type='method'><a href="CacheFactory.html#exists">exists</a></li><li data-type='method'><a href="CacheFactory.html#get">get</a></li><li data-type='method'><a href="CacheFactory.html#info">info</a></li><li data-type='method'><a href="CacheFactory.html#keys">keys</a></li><li data-type='method'><a href="CacheFactory.html#keySet">keySet</a></li><li data-type='method'><a href="CacheFactory.html#removeExpiredFromAll">removeExpiredFromAll</a></li><li data-type='method'><a href="CacheFactory.html#touchAll">touchAll</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-cachefactory.html">cachefactory</a></li></ul><h3>Namespaces</h3><ul><li><a href="utils.html">utils</a><ul class='methods'><li data-type='method'><a href="utils.html#.equals">equals</a></li><li data-type='method'><a href="utils.html#.fromJson">fromJson</a></li><li data-type='method'><a href="utils.html#.isFunction">isFunction</a></li><li data-type='method'><a href="utils.html#.isNumber">isNumber</a></li><li data-type='method'><a href="utils.html#.isObject">isObject</a></li><li data-type='method'><a href="utils.html#.isString">isString</a></li><li data-type='method'><a href="utils.html#.toJson">toJson</a></li></ul></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-basics.html">The Basics</a></li><li><a href="tutorial-working-with-a-cache.html">Working with a cache</a></li><li><a href="tutorial-working-with-localstorage.html">Working with localStorage</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">CacheFactory.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import defaults from './defaults'
/**
 * A instance of `CacheFactory` holds multiple caches, and provides methods for
 * manipulating all of the caches at once.
 *
 * @example
 * import CacheFactory from 'cachefactory';
 *
 * const cacheFactory = new CacheFactory();
 * const cache = cacheFactory.createCache('my-cache');
 *
 * @class CacheFactory
 */
export default class CacheFactory {
  constructor () {
    Object.defineProperty(this, 'caches', {
      writable: true,
      value: {}
    })
  }

  /**
   * Calls {@link Cache#removeAll} on each {@link Cache} in this
   * {@link CacheFactory}.
   *
   * @example
   * cacheFactory.clearAll();
   *
   * @method CacheFactory#clearAll
   */
  clearAll () {
    this.keys().forEach((cacheId) => {
      this.get(cacheId).removeAll()
    })
  }

  /**
   * Create a new {@link Cache}. If a cache with the same `id` had been created
   * in a previous browser session, then it will attempt to load any data that
   * had been saved previously.
   *
   * @example
   * import CacheFactory from 'cachefactory';
   *
   * const cacheFactory = new CacheFactory();
   * const options = {...};
   * const cache = cacheFactory.createCache('my-cache', options);
   *
   * cache.put('foo', 'bar');
   * console.log(cache.get('foo')); // "bar"
   *
   * @method CacheFactory#createCache
   * @param {string} id A unique identifier for the new {@link Cache}.
   * @param {object} [options] Configuration options. See {@link Cache}.
   * @returns {Cache} The new {@link Cache} instance.
   */
  createCache (id, options = {}) {
    if (this.caches[id]) {
      throw new Error(`cache "${id}" already exists!`)
    }
    options.parent = this
    this.caches[id] = new CacheFactory.Cache(id, options)
    return this.caches[id]
  }

  /**
   * Calls {@link Cache#destroy} on the {@link Cache} in this
   * {@link CacheFactory} that has the specified `id`.
   *
   * @example
   * cacheFactory.destroy('my-cache');
   *
   * @method CacheFactory#destroy
   * @param {string} id TODO
   */
  destroy (id) {
    this.get(id).destroy()
    this.caches[id] = undefined
  }

  /**
   * Calls {@link Cache#destroy} on each {@link Cache} in this
   * {@link CacheFactory}.
   *
   * @example
   * cacheFactory.destroyAll();
   *
   * @method CacheFactory#destroyAll
   */
  destroyAll () {
    this.keys().forEach((id) => {
      this.get(id).destroy()
    })
    this.caches = {}
  }

  /**
   * Calls {@link Cache#disable} on each {@link Cache} in this
   * {@link CacheFactory}.
   *
   * @example
   * cacheFactory.disableAll();
   *
   * @method CacheFactory#disableAll
   */
  disableAll () {
    this.keys().forEach((cacheId) => {
      this.get(cacheId).disable()
    })
  }

  /**
   * Calls {@link Cache#enable} on each {@link Cache} in this
   * {@link CacheFactory}.
   *
   * @example
   * cacheFactory.enableAll();
   *
   * @method CacheFactory#enableAll
   */
  enableAll () {
    this.keys().forEach((cacheId) => {
      this.get(cacheId).enable()
    })
  }

  /**
   * Returns whether the {@link Cache} with the specified `id` exists in this
   * {@link CacheFactory}.
   *
   * @example
   * const exists = cacheFactory.exists('my-cache');
   *
   * @method CacheFactory#exists
   * @returns {boolean} Whether the {@link Cache} with the specified `id` exists
   * in this {@link CacheFactory}.
   */
  exists (id) {
    return !!this.caches[id]
  }

  /**
   * Returns a reference to the {@link Cache} in this {@link CacheFactory} that
   * has the specified `id`.
   *
   * @example
   * const cache = cacheFactory.get('my-cache');
   *
   * @method CacheFactory#get
   * @param {string} id The `id` of the {@link Cache} to retrieve.
   * @returns {Cache} The {@link Cache} instance.
   * @throws {ReferenceError} Throws a `ReferenceError` if the {@link Cache}
   * does not exist.
   */
  get (id) {
    const cache = this.caches[id]
    if (!cache) {
      throw new ReferenceError(`Cache "${id}" does not exist!`)
    }
    return cache
  }

  /**
   * Returns information on this {@link CacheFactory} and its {@link Cache}
   * instance.
   *
   * @example
   * const info = cacheFactory.info();
   * info.size; // 3
   * info.caches['my-cache']; // { size: 1234, ... }
   * info.caches['my-cache2']; // { size: 51, ... }
   * info.caches['my-cache3']; // { size: 43, ... }
   *
   * @method CacheFactory#info
   * @returns {object} The detailed information.
   */
  info () {
    const keys = this.keys()
    const info = {
      size: keys.length,
      caches: {}
    }
    keys.forEach((cacheId) => {
      info.caches[cacheId] = this.get(cacheId).info()
    })
    Object.keys(defaults).forEach((key, value) => {
      info[key] = defaults[key]
    })
    return info
  }

  /**
   * Returns an array of identifiers of the {@link Cache} instances in this
   * {@link CacheFactory}.
   *
   * @example
   * const keys = cacheFactory.keys();
   *
   * @method CacheFactory#keys
   * @returns {string[]} The {@link Cache} identifiers.
   */
  keys () {
    return Object.keys(this.caches).filter((key) => this.caches[key])
  }

  /**
   * Returns an object of key-value pairs representing the identifiers of the
   * {@link Cache} instances in this {@link CacheFactory}.
   *
   * @example
   * const keySet = cacheFactory.keySet();
   *
   * @method CacheFactory#keySet
   * @returns {object} The {@link Cache} identifiers.
   */
  keySet () {
    const set = {}
    this.keys().forEach((key) => {
      set[key] = key
    })
    return set
  }

  /**
   * Calls {@link Cache#removeExpired} on each {@link Cache} in this
   * {@link CacheFactory} and returns the removed items, if any.
   *
   * @example
   * const expired = cacheFactory.removeExpiredFromAll();
   *
   * @method CacheFactory#removeExpiredFromAll
   * @returns {object} The removed items, if any.
   */
  removeExpiredFromAll () {
    const expired = {}
    this.keys().forEach((id) => {
      expired[id] = this.get(id).removeExpired()
    })
    return expired
  }

  /**
   * Calls {@link Cache#touch} on each {@link Cache} in this
   * {@link CacheFactory}.
   *
   * @example
   * cacheFactory.touchAll();
   *
   * @method CacheFactory#touchAll
   */
  touchAll () {
    this.keys().forEach((cacheId) => {
      this.get(cacheId).touch()
    })
  }
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Sun Feb 26 2017 15:33:17 GMT-0800 (PST) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
